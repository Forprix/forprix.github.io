import{$,$1,$el,$url}from"./util.mjs";const searchDoesntWork=new Audio("./assets/search-doesnt-work.ogg"),joinPleaseAudio=new Audio("./assets/please-join.ogg");joinPleaseAudio.loop=!0;const defaultTitle="Forprix";let pages;document.title="Forprix";const switchBodyPage=(()=>{const e=$1(".header-title"),t=$1(".menu-title-text"),o=$1(".body > .body-iframe");return o.addEventListener("load",(()=>{const n=o.contentWindow.location.pathname.replace(/\/$/,""),a=pages.find((e=>e.path==n));a&&(e.innerHTML=`FORPRIX /&nbsp;<div style="color:${a.color}">${a.name.toUpperCase()}</div>`,t.innerHTML=`FORPRIX /&nbsp;<div style="color:${a.color}">${a.name.toUpperCase()}</div>`);const s=o.contentWindow.location.href,r=o.contentDocument.querySelector("head > title");document.title=r?.innerText??"Forprix",history.replaceState(s,s,s)})),function(e){return new Promise((t=>{if($1(".menu").classList.remove("open"),o.src&&$url(o.src)==$url(e))return;$(".menu-location-selected").forEach((e=>e.classList.remove("menu-location-selected")));const n=$1(`.menu-location[data-path="${e}"]`);n&&n.classList.add("menu-location-selected");const a=()=>{$1(".body").classList.remove("loading"),t(),o.removeEventListener("load",a),o.removeEventListener("error",a)};o.addEventListener("load",a),o.addEventListener("error",a),$1(".body").classList.add("loading"),o.src=e}))}})();(async()=>{pages=await(await fetch("locations.json")).json();let e=!1;const t=new URL(document.location).searchParams.get("path");if(t&&(switchBodyPage(`/${t}`),e=!0),!e){const t=localStorage.getItem("path");t&&(switchBodyPage(t),e=!0)}e||switchBodyPage(pages.find((e=>e.main)).path);const o=document.querySelector(".menu-locations");for(const e of pages){const t=$el("div",{content:"FORPRIX /Â ",class:"menu-location",data:{path:e.path},child:$el("div",{content:e.name.toUpperCase(),style:{color:e.color}})});t.addEventListener("click",(()=>switchBodyPage(t.getAttribute("data-path")))),t.addEventListener("auxclick",(e=>{1==e.button&&(open(t.getAttribute("data-path")),e.preventDefault())})),o.append(t)}})(),addEventListener("beforeunload",(()=>{const e=$1(".menu-location-selected");e&&localStorage.setItem("path",e.getAttribute("data-path"))}));{const e=$1(".menu");$(".menu-button").on("click",(()=>{e.classList.contains("open")?e.classList.remove("open"):e.classList.add("open")}));const t=$1(".body > .body-iframe"),o=$1(".menu");t.addEventListener("load",(()=>t.contentDocument.addEventListener("mousedown",(()=>o.classList.remove("open"))))),$(".menu-bottom-media-discord").on("click",(()=>open("https://discord.gg/885muca","forprix-discord"))),$(".menu-bottom-media-soundcloud").on("click",(()=>open("https://soundcloud.com/forprix","forprix-soundcloud"))),$(".menu-bottom-media-github").on("click",(()=>open("https://github.com/Forprix","forprix-github"))),$(".menu-bottom-media-youtube").on("click",(()=>open("https://www.youtube.com/@forprix","forprix-youtube")))}{const e=$1(".discord-button");e.addEventListener("click",(()=>window.open("https://discord.gg/QjwC5Gs936","Discord"))),setInterval((()=>{e.style=t?`transform: scale(1.4) translate(${Math.floor(20*Math.random()-10)}px, ${Math.floor(20*Math.random()-10)}px)`:""}),1e3/60);let t=!1;e.addEventListener("mouseleave",(()=>{t=!1,joinPleaseAudio.pause()}));let o=!1;addEventListener("mousedown",(()=>o=!0)),addEventListener("keydown",(()=>o=!0)),e.addEventListener("mouseenter",(()=>{t=!0,o&&joinPleaseAudio.play()}))}{document.querySelector(".search-bar-button").addEventListener("click",(()=>{searchDoesntWork.currentTime=0,searchDoesntWork.play()}));const e=document.querySelector(".search-bar-input");e.addEventListener("keypress",(e=>{"Enter"==e.code&&e.preventDefault()})),e.addEventListener("input",(()=>{document.querySelector(".body .body-iframe").contentWindow.postMessage({type:"search",data:e.innerText},"*"),""==e.innerText?document.querySelector(".search-bar-placeholder").style="":document.querySelector(".search-bar-placeholder").style="display: none;"}))}
